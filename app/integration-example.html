<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SideDrawer Integration - Full Example</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #f5f7fa;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 30px;
      margin-bottom: 20px;
      text-align: center;
    }

    .header h1 {
      color: #2c3e50;
      font-size: 28px;
      margin-bottom: 10px;
    }

    .tabs {
      display: flex;
      gap: 10px;
      background: white;
      padding: 10px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }

    .tab {
      flex: 1;
      padding: 12px 20px;
      background: #f8f9fa;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      color: #555;
      transition: all 0.3s;
    }

    .tab.active {
      background: #3498db;
      color: white;
    }

    .tab:hover {
      background: #e9ecef;
    }

    .tab.active:hover {
      background: #2980b9;
    }

    .content {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 30px;
      min-height: 400px;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .document-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .document-card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .document-card:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      transform: translateY(-2px);
    }

    .document-icon {
      width: 50px;
      height: 50px;
      background: #3498db;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 24px;
      margin-bottom: 10px;
    }

    .document-title {
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 5px;
    }

    .document-meta {
      font-size: 12px;
      color: #7f8c8d;
    }

    .client-list {
      margin-top: 20px;
    }

    .client-item {
      display: flex;
      align-items: center;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .client-item:hover {
      background: #f8f9fa;
      border-color: #3498db;
    }

    .client-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: #3498db;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      margin-right: 15px;
    }

    .client-info {
      flex: 1;
    }

    .client-name {
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 3px;
    }

    .client-email {
      font-size: 14px;
      color: #7f8c8d;
    }

    .btn {
      display: inline-block;
      padding: 10px 20px;
      background: #3498db;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
    }

    .btn:hover {
      background: #2980b9;
    }

    .btn-success {
      background: #27ae60;
    }

    .btn-success:hover {
      background: #229954;
    }

    .action-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #f0f0f0;
    }

    .search-box {
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 6px;
      width: 300px;
      font-size: 14px;
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: #7f8c8d;
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #7f8c8d;
    }

    .empty-state-icon {
      font-size: 64px;
      margin-bottom: 20px;
      opacity: 0.3;
    }

    .share-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .share-modal.active {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: 12px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
    }

    .modal-header {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 20px;
      color: #2c3e50;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: #555;
    }

    .form-input {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
    }

    .form-textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      min-height: 100px;
      resize: vertical;
    }

    .modal-actions {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-top: 20px;
    }

    .btn-secondary {
      background: #95a5a6;
    }

    .btn-secondary:hover {
      background: #7f8c8d;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üîê SideDrawer for Zoho CRM</h1>
      <p>Manage documents and share securely with your clients</p>
    </div>

    <div class="tabs">
      <button class="tab active" onclick="switchTab('documents')">üìÑ Documents</button>
      <button class="tab" onclick="switchTab('clients')">üë• Clients</button>
      <button class="tab" onclick="switchTab('share')">üì§ Share</button>
      <button class="tab" onclick="switchTab('activity')">üìä Activity</button>
    </div>

    <div class="content">
      <!-- Documents Tab -->
      <div id="documents-tab" class="tab-content active">
        <div class="action-bar">
          <h2>My Documents</h2>
          <div style="display: flex; gap: 10px;">
            <input type="text" class="search-box" placeholder="Search documents..." id="doc-search">
            <button class="btn btn-success">‚ûï Upload</button>
          </div>
        </div>
        <div id="documents-list" class="loading">
          Loading documents...
        </div>
      </div>

      <!-- Clients Tab -->
      <div id="clients-tab" class="tab-content">
        <div class="action-bar">
          <h2>My Clients</h2>
          <button class="btn btn-success">‚ûï Add Client</button>
        </div>
        <div id="clients-list" class="loading">
          Loading clients...
        </div>
      </div>

      <!-- Share Tab -->
      <div id="share-tab" class="tab-content">
        <div class="action-bar">
          <h2>Share Documents</h2>
        </div>
        <div style="padding: 20px;">
          <p style="color: #7f8c8d; margin-bottom: 20px;">
            Select a document and client to create a secure share link
          </p>
          
          <div class="form-group">
            <label class="form-label">Select Document</label>
            <select id="share-document" class="form-input">
              <option value="">Choose a document...</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label">Select Client</label>
            <select id="share-client" class="form-input">
              <option value="">Choose a client...</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label">Message (Optional)</label>
            <textarea id="share-message" class="form-textarea" placeholder="Add a personal message..."></textarea>
          </div>

          <button class="btn btn-success" onclick="shareDocument()">üì§ Share Document</button>
        </div>
      </div>

      <!-- Activity Tab -->
      <div id="activity-tab" class="tab-content">
        <div class="action-bar">
          <h2>Recent Activity</h2>
          <select class="form-input" style="width: 200px;">
            <option>Last 7 days</option>
            <option>Last 30 days</option>
            <option>Last 90 days</option>
          </select>
        </div>
        <div id="activity-list" class="loading">
          Loading activity...
        </div>
      </div>
    </div>
  </div>

  <!-- Share Modal -->
  <div id="share-modal" class="share-modal">
    <div class="modal-content">
      <div class="modal-header">Document Shared Successfully!</div>
      <p style="margin-bottom: 20px; color: #555;">
        Your document has been securely shared. The client will receive an email notification.
      </p>
      <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 20px;">
        <strong>Share Link:</strong><br>
        <code id="share-link" style="font-size: 12px; word-break: break-all;"></code>
      </div>
      <div class="modal-actions">
        <button class="btn" onclick="copyShareLink()">Copy Link</button>
        <button class="btn btn-secondary" onclick="closeShareModal()">Close</button>
      </div>
    </div>
  </div>

  <script src="sidedrawer-api.js"></script>
  <script>
    // Initialize API
    const api = new SideDrawerAPI();

    // Sample data (replace with actual API calls)
    const sampleDocuments = [
      { id: '1', name: 'Tax Return 2024.pdf', type: 'pdf', size: '2.4 MB', date: '2024-11-15' },
      { id: '2', name: 'Investment Portfolio.xlsx', type: 'excel', size: '1.2 MB', date: '2024-11-10' },
      { id: '3', name: 'Estate Plan.docx', type: 'word', size: '856 KB', date: '2024-11-05' }
    ];

    const sampleClients = [
      { id: '1', name: 'John Smith', email: 'john.smith@example.com', initials: 'JS' },
      { id: '2', name: 'Sarah Johnson', email: 'sarah.j@example.com', initials: 'SJ' },
      { id: '3', name: 'Michael Brown', email: 'mbrown@example.com', initials: 'MB' }
    ];

    const sampleActivity = [
      { type: 'share', user: 'You', action: 'shared "Tax Return 2024.pdf"', client: 'John Smith', time: '2 hours ago' },
      { type: 'view', user: 'Sarah Johnson', action: 'viewed "Investment Portfolio.xlsx"', time: '5 hours ago' },
      { type: 'upload', user: 'You', action: 'uploaded "Estate Plan.docx"', time: '1 day ago' }
    ];

    // Tab switching
    function switchTab(tabName) {
      // Update tab buttons
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      event.target.classList.add('active');

      // Update tab content
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      document.getElementById(`${tabName}-tab`).classList.add('active');

      // Load tab data
      loadTabData(tabName);
    }

    // Load tab data
    function loadTabData(tabName) {
      switch(tabName) {
        case 'documents':
          loadDocuments();
          break;
        case 'clients':
          loadClients();
          break;
        case 'share':
          loadShareOptions();
          break;
        case 'activity':
          loadActivity();
          break;
      }
    }

    // Load documents
    async function loadDocuments() {
      const container = document.getElementById('documents-list');
      
      try {
        // In real implementation, use:
        // const documents = await api.getDocuments();
        
        // For demo, use sample data
        await new Promise(resolve => setTimeout(resolve, 500));
        const documents = sampleDocuments;

        if (documents.length === 0) {
          container.innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon">üìÑ</div>
              <h3>No documents yet</h3>
              <p>Upload your first document to get started</p>
            </div>
          `;
          return;
        }

        container.innerHTML = `
          <div class="document-grid">
            ${documents.map(doc => `
              <div class="document-card" onclick="viewDocument('${doc.id}')">
                <div class="document-icon">üìÑ</div>
                <div class="document-title">${doc.name}</div>
                <div class="document-meta">${doc.size} ‚Ä¢ ${doc.date}</div>
              </div>
            `).join('')}
          </div>
        `;
      } catch (error) {
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">‚ö†Ô∏è</div>
            <h3>Error loading documents</h3>
            <p>${error.message}</p>
          </div>
        `;
      }
    }

    // Load clients
    async function loadClients() {
      const container = document.getElementById('clients-list');
      
      try {
        // In real implementation, use:
        // const clients = await api.getClients();
        
        await new Promise(resolve => setTimeout(resolve, 500));
        const clients = sampleClients;

        container.innerHTML = `
          <div class="client-list">
            ${clients.map(client => `
              <div class="client-item" onclick="viewClient('${client.id}')">
                <div class="client-avatar">${client.initials}</div>
                <div class="client-info">
                  <div class="client-name">${client.name}</div>
                  <div class="client-email">${client.email}</div>
                </div>
              </div>
            `).join('')}
          </div>
        `;
      } catch (error) {
        container.innerHTML = `<div class="empty-state">Error loading clients: ${error.message}</div>`;
      }
    }

    // Load share options
    function loadShareOptions() {
      const docSelect = document.getElementById('share-document');
      const clientSelect = document.getElementById('share-client');

      // Populate document dropdown
      docSelect.innerHTML = '<option value="">Choose a document...</option>' +
        sampleDocuments.map(doc => `<option value="${doc.id}">${doc.name}</option>`).join('');

      // Populate client dropdown
      clientSelect.innerHTML = '<option value="">Choose a client...</option>' +
        sampleClients.map(client => `<option value="${client.id}">${client.name}</option>`).join('');
    }

    // Load activity
    async function loadActivity() {
      const container = document.getElementById('activity-list');
      
      try {
        await new Promise(resolve => setTimeout(resolve, 500));
        const activities = sampleActivity;

        container.innerHTML = `
          <div class="client-list">
            ${activities.map(activity => {
              const icon = activity.type === 'share' ? 'üì§' : 
                          activity.type === 'view' ? 'üëÅÔ∏è' : 'üì§';
              return `
                <div class="client-item">
                  <div class="client-avatar">${icon}</div>
                  <div class="client-info">
                    <div class="client-name">${activity.user} ${activity.action}</div>
                    <div class="client-email">${activity.client || ''} ‚Ä¢ ${activity.time}</div>
                  </div>
                </div>
              `;
            }).join('')}
          </div>
        `;
      } catch (error) {
        container.innerHTML = `<div class="empty-state">Error loading activity: ${error.message}</div>`;
      }
    }

    // Share document
    async function shareDocument() {
      const docId = document.getElementById('share-document').value;
      const clientId = document.getElementById('share-client').value;
      const message = document.getElementById('share-message').value;

      if (!docId || !clientId) {
        alert('Please select both a document and a client');
        return;
      }

      try {
        // In real implementation, use:
        // const result = await api.shareDocument(docId, {
        //   recipientId: clientId,
        //   message: message
        // });

        // For demo:
        const shareLink = `https://sidedrawer.com/shared/${Math.random().toString(36).substr(2, 9)}`;
        
        document.getElementById('share-link').textContent = shareLink;
        document.getElementById('share-modal').classList.add('active');
        
        // Reset form
        document.getElementById('share-document').value = '';
        document.getElementById('share-client').value = '';
        document.getElementById('share-message').value = '';
      } catch (error) {
        alert('Error sharing document: ' + error.message);
      }
    }

    // View document
    function viewDocument(docId) {
      console.log('View document:', docId);
      alert('Document viewer would open here');
    }

    // View client
    function viewClient(clientId) {
      console.log('View client:', clientId);
      alert('Client details would open here');
    }

    // Copy share link
    function copyShareLink() {
      const link = document.getElementById('share-link').textContent;
      navigator.clipboard.writeText(link).then(() => {
        alert('Link copied to clipboard!');
      });
    }

    // Close share modal
    function closeShareModal() {
      document.getElementById('share-modal').classList.remove('active');
    }

    // Initialize on load
    document.addEventListener('DOMContentLoaded', () => {
      // Check authentication
      if (!api.isAuthenticated()) {
        alert('Please connect to SideDrawer first using widget.html');
        return;
      }

      // Load initial tab
      loadDocuments();
    });

    // Search functionality
    document.getElementById('doc-search').addEventListener('input', (e) => {
      const query = e.target.value.toLowerCase();
      const cards = document.querySelectorAll('.document-card');
      
      cards.forEach(card => {
        const title = card.querySelector('.document-title').textContent.toLowerCase();
        card.style.display = title.includes(query) ? 'block' : 'none';
      });
    });
  </script>
</body>
</html>

